(list
 (Extern 'peek_byte)
 (Extern 'read_byte)
 (Extern 'write_byte)
 (Extern 'raise_error)
 (Label 'entry)
 (Mov 'rbx 'rdi)
 (Mov 'rax 16)
 (Push 'rax)
 (Mov 'rax 32)
 (Pop 'r8)
 (Mov 'r9 'r8)
 (And 'r9 15)
 (Cmp 'r9 0)
 (Jne 'raise_error)
 (Mov 'r9 'rax)
 (And 'r9 15)
 (Cmp 'r9 0)
 (Jne 'raise_error)
 (Add 'rax 'r8)
 (Mov 'rdx 'rbx)
 (Ret))
